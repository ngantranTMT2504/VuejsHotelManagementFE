<template>
    <main>
        <div class="banner-wrapper">
            <div class="row w-100 m-0">
                <div class="col-lg-8 p-0 m-0">
                    <img :src="BannerBooking1" alt="" class="w-100 h-100">
                </div>
                <div class="col-lg-4 p-0 m-0">
                    <img :src="BannerBooking2" alt="" class="w-100 h-100">
                </div>
            </div>
        </div>
        <div class="container booking-wrapper py-5">
            <div class="row">
                <div class="col-lg-6 ">
                    <div class="introduct me-4">
                        <h4 class="fw-semibold">Interesting Experience</h4>
                        <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Alias voluptatibus ut enim. Ad
                            quasi quia pariatur voluptates, id inventore vitae, voluptate reiciendis tempora ab harum et
                            minima cupiditate facilis asperiores.</p>
                        <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Modi, error pariatur odio
                            consequuntur sapiente corrupti id porro non quis quidem, culpa, ad vitae ipsa nulla nesciunt
                            eum esse! Numquam, quo.</p>
                        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Quidem unde sed incidunt maxime
                            dolores, harum commodi architecto labore odit magnam consequatur culpa optio ipsa
                            reprehenderit odio cumque temporibus enim ducimus. </p>
                        <hr class="my-5">
                    </div>
                    <div class="Amenities me-4 mb-5">
                        <h4 class="fw-semibold">Amenities</h4>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="m-3">
                                    <span class="me-4 svg-amenities">
                                        <svg class="qodef-ei-svg-icon qodef--air-condition"
                                            xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24"
                                            viewBox="0 0 24 20" enable-background="new 0 0 24 20" xml:space="preserve">
                                            <g>
                                                <path
                                                    d="M21.5,12.5h-19c-1.1,0-2-0.9-2-2v-9c0-0.6,0.4-1,1-1h21c0.6,0,1,0.4,1,1v9C23.5,11.6,22.6,12.5,21.5,12.5z">
                                                </path>
                                                <line x1="0.5" y1="6.5" x2="23.5" y2="6.5"></line>
                                                <path
                                                    d="M18.5,9.5h-13c-0.6,0-1,0.4-1,1v2h15v-2C19.5,9.9,19.1,9.5,18.5,9.5z">
                                                </path>
                                                <path d="M17.5,15.5c0,2,2,4,4,4"></path>
                                                <path d="M6.5,15.5c0,2-2,4-4,4"></path>
                                                <circle cx="3.5" cy="3.5" r="0.5"></circle>
                                                <circle cx="5.5" cy="3.5" r="0.5"></circle>
                                            </g>
                                        </svg>
                                    </span>
                                    <span class="">Air conditioner</span>
                                </div>
                                <div class="m-3">
                                    <span class="me-4 svg-amenities">
                                        <svg class="qodef-ei-svg-icon qodef--bath" xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24"
                                            viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
                                            <g>
                                                <path
                                                    d="M16.5,21.5h-9c-3.3,0-6-2.7-6-6v-4h21v4C22.5,18.8,19.8,21.5,16.5,21.5z">
                                                </path>
                                                <line x1="0.5" y1="11.5" x2="23.5" y2="11.5"></line>
                                                <line x1="6.5" y1="21.5" x2="5.5" y2="23.5"></line>
                                                <line x1="17.5" y1="21.5" x2="18.5" y2="23.5"></line>
                                                <line x1="1.5" y1="4.5" x2="1.5" y2="11.5"></line>
                                                <path
                                                    d="M1.5,4.5V3c0-1.4,1.1-2.5,2.5-2.5l0,0c1.4,0,2.5,1.1,2.5,2.5v0.5">
                                                </path>
                                                <line x1="5.5" y1="6.5" x2="5.5" y2="7.5"></line>
                                                <line x1="7.5" y1="8.5" x2="7.5" y2="9.5"></line>
                                                <line x1="7.5" y1="5.5" x2="7.5" y2="6.5"></line>
                                            </g>
                                        </svg>
                                    </span>
                                    <span class="">Bathtub</span>
                                </div>
                                <div class="m-3">
                                    <span class="me-4 svg-amenities">
                                        <svg class="qodef-ei-svg-icon qodef--tv" xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24"
                                            viewBox="0 0 24 19" xml:space="preserve">
                                            <g>
                                                <g>
                                                    <path
                                                        d="M22.5,15.5h-21c-0.6,0-1-0.4-1-1v-13c0-0.6,0.4-1,1-1h21c0.6,0,1,0.4,1,1v13C23.5,15.1,23.1,15.5,22.5,15.5z">
                                                    </path>
                                                    <polyline points="19.5,18.5 17.5,15.5 6.5,15.5 4.5,18.5"></polyline>
                                                </g>
                                                <line x1="4.5" y1="3.5" x2="2.5" y2="5.5"></line>
                                                <line x1="8.5" y1="3.5" x2="2.5" y2="9.5"></line>
                                            </g>
                                        </svg>
                                    </span>
                                    <span class="">Cable TV</span>
                                </div>
                                <div class="m-3">
                                    <span class="me-4 svg-amenities">
                                        <svg class="qodef-ei-svg-icon qodef--map" xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22.5"
                                            viewBox="0 0 22.5 22" xml:space="preserve">
                                            <g>
                                                <path
                                                    d="M0.5,1.9v14.9c0,0.4,0.2,0.7,0.5,0.9l6.5,3.5c0.3,0.1,0.6,0.1,0.9,0l5.7-3.5c0.3-0.2,0.6-0.2,0.9,0l5.7,3c0.6,0.3,1.4-0.2,1.4-0.9V4.2c0-0.4-0.2-0.8-0.6-0.9l-6.5-2.6c-0.2-0.1-0.5-0.1-0.7,0L8.3,3.3c-0.2,0.1-0.5,0.1-0.7,0L1.8,1C1.2,0.8,0.5,1.2,0.5,1.9z">
                                                </path>
                                                <line x1="8" y1="21.5" x2="8" y2="3.5"></line>
                                                <line x1="14.5" y1="17.5" x2="14.5" y2="0.5"></line>
                                            </g>
                                        </svg>
                                    </span>
                                    <span class="">City map</span>
                                </div>
                                <div class="m-3">
                                    <span class="me-4 svg-amenities">
                                        <svg class="qodef-ei-svg-icon qodef--luggage" xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15.3"
                                            viewBox="0 0 15.3 27.3" xml:space="preserve">
                                            <g>
                                                <path
                                                    d="M11.8,25.2H3.5c-1.6,0-3-1.4-3-3V9.6c0-1.6,1.4-3,3-3h8.3c1.7,0,3,1.3,3,3v12.7C14.8,23.9,13.5,25.2,11.8,25.2z">
                                                </path>
                                                <path d="M0.5,13.3c0-1.6,1.4-3,3-3h8.3c1.7,0,3,1.4,3,3"></path>
                                                <path d="M9.4,6.6V1.5c0-0.6-0.4-1-1-1H6.9c-0.6,0-1,0.4-1,1v5.1"></path>
                                                <g>
                                                    <line x1="4" y1="25.2" x2="4" y2="26.8"></line>
                                                    <line x1="11.3" y1="25.2" x2="11.3" y2="26.8"></line>
                                                </g>
                                            </g>
                                        </svg>
                                    </span>
                                    <span class="">Luggage Storage</span>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="m-3">
                                    <span class="me-4 svg-amenities">
                                        <svg class="qodef-ei-svg-icon qodef--pool" xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22.2"
                                            viewBox="0 0 22.2 22.1" xml:space="preserve">
                                            <g>
                                                <path
                                                    d="M0.5,19.9c1.8,0,1.8,1.7,3.5,1.7c1.8,0,1.8-1.7,3.5-1.7c1.8,0,1.8,1.7,3.5,1.7c1.8,0,1.8-1.7,3.5-1.7c1.8,0,1.8,1.7,3.5,1.7c1.8,0,1.8-1.7,3.5-1.7">
                                                </path>
                                                <path d="M10.6,5.1V3.3c0-1.5-1.2-2.8-2.8-2.8S5.1,1.7,5.1,3.3V18"></path>
                                                <path d="M21.7,5.1V3.3c0-1.5-1.2-2.8-2.8-2.8s-2.8,1.2-2.8,2.8V18">
                                                </path>
                                                <line x1="5.1" y1="8.8" x2="16.1" y2="8.8"></line>
                                                <line x1="5.1" y1="14.3" x2="16.1" y2="14.3"></line>
                                            </g>
                                        </svg>
                                    </span>
                                    <span class="">Swimming Pool</span>
                                </div>
                                <div class="m-3">
                                    <span class="me-4 svg-amenities">
                                        <svg class="qodef-ei-svg-icon qodef--hair-dryer"
                                            xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22"
                                            viewBox="0 0 22 23" enable-background="new 0 0 22 23" xml:space="preserve">
                                            <g>
                                                <path
                                                    d="M20.5,3.5h-5C14.2,3.5,13,3,12,2.1c-1.5-1.3-3.6-1.9-5.8-1.5c-2.8,0.5-5,2.7-5.5,5.5c-0.9,4.5,2.5,8.4,6.9,8.4c1.7,0,3.2-0.6,4.4-1.6c1.1-0.9,2.4-1.4,3.8-1.4h4.8c0.6,0,1-0.4,1-1v-6C21.5,3.9,21.1,3.5,20.5,3.5z">
                                                </path>
                                                <path
                                                    d="M10.5,13.8v7.7c0,0.5-0.5,1-1,1h-2c-0.6,0-1-0.4-1-1C6.4,18.1,5.9,16,4.8,14">
                                                </path>
                                                <circle cx="7.5" cy="7.5" r="3"></circle>
                                            </g>
                                        </svg>
                                    </span>
                                    <span class="">Hairdryer</span>
                                </div>
                                <div class="m-3">
                                    <span class="me-4 svg-amenities">
                                        <svg class="qodef-ei-svg-icon qodef--wifi" xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22.3"
                                            viewBox="0 0 22.3 18" xml:space="preserve">
                                            <g>
                                                <path d="M0.5,4.9C3.2,2.2,7,0.5,11.1,0.5s7.9,1.7,10.6,4.4"></path>
                                                <path d="M19,7.7c-2-2-4.8-3.3-7.9-3.3S5.3,5.7,3.3,7.7"></path>
                                                <path d="M16.2,10.5c-1.3-1.3-3.1-2.1-5.1-2.1s-3.8,0.8-5.1,2.1"></path>
                                                <circle cx="11.1" cy="15.6" r="2"></circle>
                                            </g>
                                        </svg>
                                    </span>
                                    <span class="">High Speed Wifi</span>
                                </div>
                                <div class="m-3">
                                    <span class="me-4 svg-amenities">
                                        <svg class="qodef-ei-svg-icon qodef--towel" xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="21.1"
                                            viewBox="0 0 21.1 19.5" xml:space="preserve">
                                            <g>
                                                <path
                                                    d="M18.2,19H5.6v-3.4h-3V2.2c0-0.9,0.8-1.7,1.7-1.7h12.2c0.9,0,1.7,0.8,1.7,1.7V19z">
                                                </path>
                                                <path d="M5.4,15.6h9.2V2.2c0-1,0.8-1.7,1.7-1.7h0.2"></path>
                                                <line x1="2.6" y1="11.4" x2="14.6" y2="11.4"></line>
                                                <line x1="0.5" y1="2.6" x2="2.4" y2="2.6"></line>
                                                <line x1="14.9" y1="2.6" x2="20.6" y2="2.6"></line>
                                            </g>
                                        </svg>
                                    </span>
                                    <span class="">Towels</span>
                                </div>
                                <div class="m-3">
                                    <span class="me-4 svg-amenities">
                                        <svg class="qodef-ei-svg-icon qodef--king-bed svg-amenities"
                                            xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24"
                                            viewBox="0 0 24 15" xml:space="preserve">
                                            <g>
                                                <path d="M23.5,12.5h-23v-4c0-0.6,0.4-1,1-1h21c0.6,0,1,0.4,1,1V12.5z">
                                                </path>
                                                <path d="M21.5,7.5h-19v-5c0-1.1,0.9-2,2-2h15c1.1,0,2,0.9,2,2V7.5z">
                                                </path>
                                                <path d="M10.5,7.5h-5v-3c0-0.6,0.4-1,1-1h3c0.6,0,1,0.4,1,1V7.5z"></path>
                                                <path d="M18.5,7.5h-5v-3c0-0.6,0.4-1,1-1h3c0.6,0,1,0.4,1,1V7.5z"></path>
                                                <line x1="1.5" y1="12.5" x2="1.5" y2="14.5"></line>
                                                <line x1="22.5" y1="12.5" x2="22.5" y2="14.5"></line>
                                            </g>
                                        </svg>
                                    </span>
                                    <span class="">King Size Bed</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="rule me-4">
                        <h4 class="fw-semibold">House Rules</h4>
                        <p>-No smoking</p>
                        <p>-Check-in time is 12 PM - 2 PM and check-out by 11 AM.</p>
                    </div>
                </div>
                <div class="col-lg-6 text-white">
                    <div class="form-wrapper py-5 rounded-4 ">
                        <h3 class="mb-4 text-center">Your Reservation</h3>
                        <form class="px-5">
                            <div class="mb-3">
                                <label for="check-in" class="form-label fw-semibold">Check-in</label>
                                <input type="date" class="form-control" v-model="checkInDate" required />
                            </div>
                            <div class="mb-3">
                                <label for="check-out" class="form-label fw-semibold">Check-out</label>
                                <input type="date" class="form-control" v-model="checkOutDate" required />
                            </div>

                            <div class="mb-3">
                                <label class="form-label fw-semibold">Room</label>
                                <select v-model.number="roomCount" class="form-select">
                                    <option :value="1">1</option>
                                    <option :value="2">2</option>
                                    <option :value="3">3</option>
                                </select>
                            </div>

                            <div class="row mb-3">
                                <label class="form-label fw-semibold">Peoples</label>
                                <div class="col-lg mb-6 mb-lg-0">
                                    <select class="form-select" v-model.number="selectedAdults">
                                        <option disabled>Adults</option>
                                        <option :value="1">1</option>
                                        <option :value="2">2</option>
                                        <option :value="3">3</option>
                                        <option :value="4">4</option>
                                        <option :value="5">5</option>
                                        <option :value="6">6</option>
                                    </select>
                                </div>
                                <div class="col-lg mb-6 mb-lg-0">
                                    <select class="form-select" v-model.number="selectedChildren">
                                        <option disabled>Children</option>
                                        <option :value="0">0</option>
                                        <option :value="1">1</option>
                                        <option :value="2">2</option>
                                        <option :value="3">3</option>
                                        <option :value="4">4</option>
                                        <option :value="5">5</option>
                                        <option :value="6">6</option>
                                    </select>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label fw-semibold">Type room</label>
                                <select class="form-select" v-model="selectedRoomType">
                                    <option v-for="type in typeRooms" :key="type.id" :value="type.id">
                                        {{ type.name }} - {{ formatPrice(type.price) }}
                                    </option>
                                </select>
                            </div>

                            <label class="form-label fw-semibold">Extra Services</label>
                            <div v-for="service in services" :key="service.id" class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input custom-check" type="checkbox"
                                        v-model="selectedServices" :value="service.id" :id="'service-' + service.id" />
                                    <label class="form-check-label" :for="'service-' + service.id">
                                        {{ service.name }}
                                    </label>
                                    <span class="price">({{ formatPrice(service.price) }})</span>
                                </div>
                            </div>

                            <div class="mb-3">
                                <p class="fw-semibold text-white">Your price:</p>
                                <p class="text-white">{{ formatPrice(totalPrice) }}</p>
                            </div>
                            <div class="d-flex justify-content-center">
                                <RouterLink :to="{
                                    path: '/payment',
                                    query: { price: parsePrice(totalPrice) }
                                }" class="btn-payment w-100 text-center">
                                    Pay for your Booking
                                </RouterLink>

                            </div>
                        </form>

                    </div>
                </div>
            </div>
        </div>

    </main>
</template>

<script setup>
import BannerBooking1 from '@/assets/images/Booking/room-single-img-09.jpg'
import BannerBooking2 from '@/assets/images/Booking/room-single-img-11.jpg'
import axios from 'axios';
import { RouterLink , useRoute, useRouter} from 'vue-router'
import { ref, onMounted, computed } from 'vue'

const route = useRoute();
const router = useRouter();
const API_GET_SERVICE = "http://localhost:5287/api/Service/GetServices"
const API_GET_TYPE_ROOM = "http://localhost:5287/api/TypeRoom/GetTypeRooms";

const services = ref([])
const typeRooms = ref([]);


const formatPrice = (value) => {
    return value.toLocaleString('vi-VN', { style: 'currency', currency: 'VND' });
}
const parsePrice = (formattedPrice) => {
    if (typeof formattedPrice !== "string") {
        formattedPrice = formattedPrice.toString(); 
    }
    return parseInt(formattedPrice.replace(/[^\d]/g, ""), 10);
};

const List = async () => {
    try {
        const responseService = await axios.get(API_GET_SERVICE);
        const responseTypeRoom = await axios.get(API_GET_TYPE_ROOM);
        services.value = responseService.data
        typeRooms.value = responseTypeRoom.data.reverse();
    } catch (error) {
        console.error("Lỗi!", error);
    }
};

const selectedServices = ref([]);
const selectedRoomType = ref(null);
const roomCount = ref(1);

const totalPrice = computed(() => {
    let serviceTotal = selectedServices.value.reduce((sum, serviceId) => {
        const service = services.value.find(s => s.id === serviceId);
        return sum + (service ? service.price : 0);
    }, 0);

    let roomPrice = 0;
    if (selectedRoomType.value) {
        const room = typeRooms.value.find(r => r.id === selectedRoomType.value);
        roomPrice = room ? room.price : 0;
    }

    return (serviceTotal + roomPrice) * roomCount.value;
})

onMounted(List);

</script>

<style>
.qodef-ei-svg-icon {
    stroke: #caa169;
    stroke-linecap: round;
    stroke-miterlimit: 10;
    fill: none;
}

.btn-payment {
    background-color: var(--secondary-color);
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
    font-weight: 700;
    padding: 10px 0;
    border-radius: 50px;
    transition: 0.3s ease-in-out;
}

.btn-payment:hover {
    background-color: var(--primary-color);
    color: var(--secondary-color);
    border: 2px solid var(--secondary-color);

}

/* Form Booking*/
.form-wrapper {
    background-color: var(--primary-color);
}

.form-check {
    position: relative;
}

.custom-check:checked {
    background-color: #caa169 !important;
    box-shadow: none !important;
    outline: none !important;

}

.custom-check:focus {
    box-shadow: none !important;
    outline: none !important;
}

.price {
    position: absolute;
    top: 0;
    right: 0;
}
</style>